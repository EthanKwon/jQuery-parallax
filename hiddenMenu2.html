<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width"
    />

    <title>Parallax</title>
    <link
      href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i'"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Abel"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./stylesHidden.css" />
  </head>
  <body>
    <nav id="nav">
      <h1>WEB'S</h1>
      <div class="mNav">
        <div class="icon-wrap">
          <div class="icon"></div>
        </div>
      </div>

      <ul class="menu">
        <li class="active"><a href="#section1">menu1</a></li>
        <li><a href="#section2">menu2</a></li>
        <li><a href="#section3">menu3</a></li>
        <li><a href="#section4">menu4</a></li>
        <li><a href="#section5">menu5</a></li>
        <li><a href="#section6">menu6</a></li>
      </ul>
    </nav>

    <div id="contents">
      <div id="section1">
        <h2>모든 인생은 <strong>실험이다.</strong></h2>
      </div>
      <div id="section2">
        <h2>시간은 <strong>금이다.</strong></h2>
      </div>
      <div id="section3">
        <h2>피할 수 없으면 <strong>즐겨라!</strong></h2>
      </div>
      <div id="section4">
        <h2>삶이 있는 한 <strong>희망</strong>은 있다.</h2>
      </div>
      <div id="section5">
        <h2>먼저핀 꽃은 <strong>먼저진다.</strong></h2>
      </div>
      <div id="section6">
        <h2>내일은 내일의 <strong>태양이 뜬다.</strong></h2>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script>
      const navList = $("#nav ul li");
      const cont = $("#contents > div");

      navList.click(e => {
        e.preventDefault();
        const target = $(e.currentTarget);
        const index = target.index();
        const section = cont.eq(index);
        const offset = section.offset().top;
        $("html,body").animate({ scrollTop: offset }, 600, "easeInOutExpo");
      });

      $(window).scroll(() => {
        const wScroll = $(this).scrollTop();

        if (wScroll >= cont.eq(0).offset().top) {
          navList.removeClass("active");
          navList.eq(0).addClass("active");
        }
        if (wScroll >= cont.eq(1).offset().top) {
          navList.removeClass("active");
          navList.eq(1).addClass("active");
        }
        if (wScroll >= cont.eq(2).offset().top) {
          navList.removeClass("active");
          navList.eq(2).addClass("active");
        }
        if (wScroll >= cont.eq(3).offset().top) {
          navList.removeClass("active");
          navList.eq(3).addClass("active");
        }
        if (wScroll >= cont.eq(4).offset().top) {
          navList.removeClass("active");
          navList.eq(4).addClass("active");
        }
        if (wScroll >= cont.eq(5).offset().top) {
          navList.removeClass("active");
          navList.eq(5).addClass("active");
        }
      });

      const wHeight = $(window).height();
      const dHeight = $(document).height();
      const navHeight = $("#nav").outerHeight();
      let lastScrollTop = 0;
      let moveScroll;

      $(window).scroll(() => {
        // 스크롤 감지
        moveScroll = true;
      });

      setInterval(() => {
        // 스크롤 감지를 0.25초 마다 확인
        if (moveScroll) {
          hasScroll();
          moveScroll = false;
        }
      }, 250);

      const hasScroll = () => {
        const wScroll = $(this).scrollTop();
        if (wScroll > lastScrollTop && wScroll > navHeight) {
          $("#nav").addClass("off");
        } else {
          if (wScroll + wHeight < dHeight) {
            $("#nav").removeClass("off");
          }
        }
        lastScrollTop = wScroll;
      };
    </script>
  </body>
</html>
